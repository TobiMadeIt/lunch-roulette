(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{279:function(e,t,a){e.exports=a.p+"static/media/placeholder_restaurant.86d14ad8.png"},280:function(e,t,a){e.exports=a.p+"static/media/pizza-logo.fd7bdaa5.png"},283:function(e,t,a){e.exports=a(504)},288:function(e,t,a){},500:function(e,t,a){},502:function(e,t,a){},504:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(61),i=a.n(o),l=(a(288),a(290),a(123)),r=a(248),s=a(249),u=a(281),d=a(250),h=a(282),m=a(22),g=a(12),f=a(279),p=a.n(f),b=(a(500),function(){}),v=function(e){var t=e.venueDetails,a=t.name,n=t.photoURL,o=t.category,i=t.tip,r=t.priceTier,s=t.distance,u=e.getNextPlace,d=e.gettingNextPlace,h=e.handleLunchClick;return c.a.createElement("div",null,c.a.createElement(g.b,{className:"place-card",fluid:!0,centered:!0},c.a.createElement("div",{style:{height:"20rem"}},c.a.createElement("img",{alt:"restaurant",style:{objectFit:"cover",width:"100%",height:"100%"},src:n||p.a})),c.a.createElement(g.b.Content,null,c.a.createElement(g.b.Header,{className:"place-header"},a),c.a.createElement(g.b.Meta,{className:"place-price"},c.a.createElement("span",null,Object(l.a)(Array(r)).map(function(e,t){return c.a.createElement(g.e,{key:t,name:"dollar",fitted:!0})}))),c.a.createElement(g.b.Meta,{className:"place-category"},c.a.createElement("span",null,o)),c.a.createElement(g.b.Meta,{className:"place-distance"},c.a.createElement("span",null,s+" mi")),c.a.createElement(g.b.Description,{className:"place-description"},i)),c.a.createElement(g.b.Content,{extra:!0},c.a.createElement(g.c,{columns:2},c.a.createElement(g.c.Column,null,c.a.createElement(g.a,{fluid:!0,target:"_blank",onClick:h,primary:!0},c.a.createElement(g.e,{name:"rocket"}),"Lunch!")),c.a.createElement(g.c.Column,null,c.a.createElement(g.a,{fluid:!0,color:"red",onClick:u,disabled:d},c.a.createElement(g.e,{name:"cancel"}),"Pass"))))))};v.defaultProps={gettingNextPlace:"false",getNextPlace:b,handleLunchClick:b};var E=v,P=a(280),w=a.n(P),y=function(e){var t=e.name,a=e.photoURL;return c.a.createElement(g.f,null,c.a.createElement(g.f.Image,{size:"tiny",src:a}),c.a.createElement(g.f.Content,{verticalAlign:"middle"},c.a.createElement(g.f.Header,{as:"a"},t)))},k=(a(502),"E35KZVRUV5YSWYBDLNFZOCEBPCOQUH44SNEZKZEWTLYTVZOA"),N="WRIM5U3CLKN4NUN0NPZVDWNRGOE4TUSD3IRO4YI5LULGEMSJ",L=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleLocationSuccess=function(e){a.loadPlaces({ll:e.coords.latitude+","+e.coords.longitude})},a.handleLocationFailure=function(){fetch("http://ipinfo.io/json?token=2a3097ff5d6dc8").then(function(e){if(e.ok)return e.json();throw Error("Couldn't get IP location")}).then(function(e){return a.loadPlaces({ll:e.loc})}).catch(console.log),alert("Please allow location access. Using rough location.")},a.state={venueResults:[],savedPlaces:[],currentVenueDetails:void 0,currentVenue:0,gettingNextPlace:!1,sidebarVisibility:!1},a.loadPlaces=a.loadPlaces.bind(Object(m.a)(Object(m.a)(a))),a.getNextPlace=a.getNextPlace.bind(Object(m.a)(Object(m.a)(a))),a.loadPlaceDetails=a.loadPlaceDetails.bind(Object(m.a)(Object(m.a)(a))),a.handleLocationFailure=a.handleLocationFailure.bind(Object(m.a)(Object(m.a)(a))),a.handleLocationSuccess=a.handleLocationSuccess.bind(Object(m.a)(Object(m.a)(a))),a.handleLunchClick=a.handleLunchClick.bind(Object(m.a)(Object(m.a)(a))),a.toggleSidebar=a.toggleSidebar.bind(Object(m.a)(Object(m.a)(a))),a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(this.handleLocationSuccess,this.handleLocationFailure):console.log("geolocation not supported"),this.loadPlaces({ll:"32.7767,-96.7970"}).then(function(t){return e.loadPlaceDetails(0)}).catch(console.log)}},{key:"loadPlaces",value:function(e){var t=this;return fetch(function(e){var t="https://api.foursquare.com/v2/venues/search?v=20170801&"+"intent=browse&radius=10000&client_id=".concat(k,"&client_secret=").concat(N)+"&categoryId=".concat("4bf58dd8d48988d14e941735,4bf58dd8d48988d142941735,4bf58dd8d48988d1df931735,4bf58dd8d48988d110941735,4bf58dd8d48988d1c1941735,4bf58dd8d48988d10f941735");for(var a in e)t+="&".concat(a,"=").concat(e[a]);return t}(e)).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){return new Promise(function(a,n){var c=e.response.venues;void 0===c||c.length<1?n("Could not find any places for that query"):(t.setState({venueResults:c}),a(c))})}).catch(function(e){alert("Couldn't load places."+e)})}},{key:"loadPlaceDetails",value:function(e){var t,a=this;this.setState({gettingNextPlace:!0}),fetch((t=this.state.venueResults[e].id,"https://api.foursquare.com/v2/venues/"+"".concat(t,"?client_id=").concat(k,"&client_secret=").concat(N,"&v=20170801"))).then(function(e){if(e.ok)return e.json();throw Error(e.statusText)}).then(function(t){var n,c,o,i,l,r,s=t.response.venue,u=s.name;try{n=s.bestPhoto.prefix+"height500"+s.bestPhoto.suffix}catch(d){n=void 0}try{c=s.categories[0].name}catch(d){c=void 0}try{o=s.price.tier}catch(d){o=0}try{(i=s.tips.groups[0].items[0].text).length>145&&(i=i.substring(0,145)+"...")}catch(d){i=""}try{l=Math.ceil(621371e-9*a.state.venueResults[e].location.distance)}catch(d){l=""}try{r="".concat(s.location.lat,",").concat(s.location.lng)}catch(d){r=""}a.setState({gettingNextPlace:!1,currentVenue:e,currentVenueDetails:{name:u,photoURL:n,category:c,priceTier:o,tip:i,distance:l,coordinates:r}})}).catch(function(e){alert("Please check your network connection "+e),a.setState({gettingNextPlace:!1})})}},{key:"getNextPlace",value:function(){var e=(this.state.currentVenue+1)%this.state.venueResults.length;this.loadPlaceDetails(e)}},{key:"handleLunchClick",value:function(){var e=this.state.currentVenueDetails,t=e.id,a=e.name,n=e.photoURL;this.setState({savedPlaces:[].concat(Object(l.a)(this.state.savedPlaces),[{id:t,name:a,photoURL:n}])}),window.open("https://www.google.com/maps/dir/?api=1&destination="+this.state.currentVenueDetails.coordinates,"_blank")}},{key:"toggleSidebar",value:function(){this.setState({sidebarVisibility:!this.state.sidebarVisibility})}},{key:"render",value:function(){return c.a.createElement(g.g.Pushable,{className:"places-sidebar"},c.a.createElement(g.g,{as:g.b,animation:"overlay",width:"wide",visible:this.state.sidebarVisibility},c.a.createElement("a",{className:"sidebar-close-toggle",onClick:this.toggleSidebar},c.a.createElement(g.e,{name:"cancel",size:"big",color:"grey"})),c.a.createElement(g.d,{textAlign:"center"},"Saved Places"),c.a.createElement(g.f.Group,{divided:!0},this.state.savedPlaces.map(function(e){return c.a.createElement(y,{key:e.id,name:e.name,photoURL:e.photoURL})}))),c.a.createElement(g.g.Pusher,null,c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("img",{src:w.a,className:"App-logo",alt:"logo"}),c.a.createElement("h1",{className:"App-title"},"Lunch Roulette"),c.a.createElement("p",null,"It's Tinder! But for restaurants"),c.a.createElement(g.a,{color:"grey",onClick:this.toggleSidebar},"Saved Places")),c.a.createElement(g.c,{centered:!0},c.a.createElement(g.c.Column,{computer:6,tablet:8,mobile:15},this.state.currentVenueDetails&&c.a.createElement(E,{venueDetails:this.state.currentVenueDetails,getNextPlace:this.getNextPlace,handleLunchClick:this.handleLunchClick,gettingNextPlace:this.state.gettingNextPlace}))),c.a.createElement("div",{className:"footer"},c.a.createElement("p",null,"Oluwatobi Oremade - Powered by Foursquare.")))))}}]),t}(n.Component),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(c.a.createElement(L,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/lunch-roulette",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/lunch-roulette","/service-worker.js");O?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):j(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):j(e)})}}()}},[[283,2,1]]]);
//# sourceMappingURL=main.abfc5b15.chunk.js.map