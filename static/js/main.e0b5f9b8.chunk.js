(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{300:function(e,t,a){e.exports=a.p+"static/media/placeholder_restaurant.86d14ad8.png"},301:function(e,t,a){e.exports=a.p+"static/media/pizza-logo.fd7bdaa5.png"},302:function(e,t,a){e.exports=a(525)},307:function(e,t,a){},521:function(e,t,a){},523:function(e,t,a){},525:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(77),i=a.n(o),r=(a(307),a(309),a(44)),l=a(3),s=a.n(l),u=a(270),d=a(8),h=a(4),m=a(5),g=a(14),f=a(13),p=a(15),b=a(30),v=a(22),E=a(299),w=a(106),L=a(300),P=a.n(L),y=(a(521),function(){}),k=function(e){var t=e.venueDetails,a=t.name,n=t.photoURL,o=t.category,i=t.tip,l=t.priceTier,s=t.distance,u=e.getNextPlace,d=e.gettingNextPlace,h=e.handleLunchClick;return c.a.createElement("div",null,c.a.createElement(v.b,{className:"place-card",fluid:!0,centered:!0},c.a.createElement("div",{style:{height:"20rem"}},c.a.createElement("img",{alt:"restaurant",style:{objectFit:"cover",width:"100%",height:"100%"},src:n||P.a})),c.a.createElement(v.b.Content,null,c.a.createElement(v.b.Header,{className:"place-header"},a),c.a.createElement(v.b.Meta,{className:"place-price"},c.a.createElement("span",null,Object(r.a)(Array(l)).map(function(e,t){return c.a.createElement(v.e,{key:t,name:"dollar",fitted:!0})}))),c.a.createElement(v.b.Meta,{className:"place-category"},c.a.createElement("span",null,o)),c.a.createElement(v.b.Meta,{className:"place-distance"},c.a.createElement("span",null,s+" mi")),c.a.createElement(v.b.Description,{className:"place-description"},i)),c.a.createElement(v.b.Content,{extra:!0},c.a.createElement(v.c,{columns:2},c.a.createElement(v.c.Column,null,c.a.createElement(v.a,{fluid:!0,target:"_blank",onClick:h,primary:!0},c.a.createElement(v.e,{name:"rocket"}),"Lunch!")),c.a.createElement(v.c.Column,null,c.a.createElement(v.a,{fluid:!0,color:"red",onClick:u,disabled:d},c.a.createElement(v.e,{name:"cancel"}),"Pass"))))))};k.defaultProps={gettingNextPlace:"false",getNextPlace:y,handleLunchClick:y};var N=k,O=a(301),j=a.n(O),x=function(e){var t=e.name,a=e.photoURL;return c.a.createElement(v.f,null,c.a.createElement(v.f.Image,{size:"tiny",src:a}),c.a.createElement(v.f.Content,{verticalAlign:"middle"},c.a.createElement(v.f.Header,{as:"a"},t)))},C=(a(523),"E35KZVRUV5YSWYBDLNFZOCEBPCOQUH44SNEZKZEWTLYTVZOA"),S="WRIM5U3CLKN4NUN0NPZVDWNRGOE4TUSD3IRO4YI5LULGEMSJ",R=(Object(E.a)({apiKey:"AIzaSyB2nxoi5NYp4HagjI5wdHU0YAUkOObR_yk",authDomain:"lunch-roulette-6a2ed.firebaseapp.com",projectId:"lunch-roulette-6a2ed",storageBucket:"lunch-roulette-6a2ed.appspot.com",messagingSenderId:"183049398068",appId:"1:183049398068:web:fada87e988644086726761",measurementId:"G-EC09RXLN5G"}),Object(w.c)()),D=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).fetchRoughLocation=function(){fetch("http://ipinfo.io/json?token=2a3097ff5d6dc8").then(function(e){if(e.ok)return e.json();throw Error("Couldn't get IP location")}).then(function(e){a.setState({roughLocation:e}),a.reportLocation(e)}).catch(console.log)},a.handleLocationSuccess=function(e){var t={};for(var n in e.coords)t[n]=e.coords[n];a.reportLocation(t),a.loadPlaces({ll:e.coords.latitude+","+e.coords.longitude})},a.handleLocationFailure=function(){a.loadPlaces({ll:a.state.roughLocation.loc})},a.state={preciseLocationFetched:!1,roughLocation:void 0,venueResults:[],savedPlaces:[],currentVenueDetails:void 0,currentVenue:0,gettingNextPlace:!1,sidebarVisibility:!1},a.loadPlaces=a.loadPlaces.bind(Object(b.a)(Object(b.a)(a))),a.getNextPlace=a.getNextPlace.bind(Object(b.a)(Object(b.a)(a))),a.loadPlaceDetails=a.loadPlaceDetails.bind(Object(b.a)(Object(b.a)(a))),a.handleLocationFailure=a.handleLocationFailure.bind(Object(b.a)(Object(b.a)(a))),a.handleLocationSuccess=a.handleLocationSuccess.bind(Object(b.a)(Object(b.a)(a))),a.handleLunchClick=a.handleLunchClick.bind(Object(b.a)(Object(b.a)(a))),a.toggleSidebar=a.toggleSidebar.bind(Object(b.a)(Object(b.a)(a))),a}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.fetchRoughLocation(),this.loadPlaces({ll:"32.7767,-96.7970"}).then(function(t){return e.loadPlaceDetails(0)}).catch(console.log)}},{key:"reportLocation",value:function(e){var t=this;try{Object(d.a)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(w.a)(Object(w.b)(R,"userLocations"),Object(u.a)({},e,{ip:t.state.roughLocation.ip,timeStamp:new Date}));case 2:n=a.sent,console.log("Document written with ID: ",n.id),t.state.preciseLocationFetched||(t.setState({preciseLocationFetched:!0}),navigator.geolocation?(console.log("getting precise location"),navigator.geolocation.getCurrentPosition(t.handleLocationSuccess,t.handleLocationFailure)):console.log("geolocation not supported"));case 5:case"end":return a.stop()}},a)}))()}catch(a){console.error("Error adding document: ",a)}}},{key:"loadPlaces",value:function(e){var t=this;return fetch(function(e){var t="https://api.foursquare.com/v2/venues/search?v=20170801&"+"intent=browse&radius=10000&client_id=".concat(C,"&client_secret=").concat(S)+"&categoryId=".concat("4bf58dd8d48988d14e941735,4bf58dd8d48988d142941735,4bf58dd8d48988d1df931735,4bf58dd8d48988d110941735,4bf58dd8d48988d1c1941735,4bf58dd8d48988d10f941735");for(var a in e)t+="&".concat(a,"=").concat(e[a]);return t}(e)).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){return new Promise(function(a,n){var c=e.response.venues;void 0===c||c.length<1?n("Could not find any places for that query"):(t.setState({venueResults:c}),a(c))})}).catch(function(e){alert("Couldn't load places."+e)})}},{key:"loadPlaceDetails",value:function(e){var t,a=this;this.setState({gettingNextPlace:!0}),fetch((t=this.state.venueResults[e].id,"https://api.foursquare.com/v2/venues/"+"".concat(t,"?client_id=").concat(C,"&client_secret=").concat(S,"&v=20170801"))).then(function(e){if(e.ok)return e.json();throw Error(e.statusText)}).then(function(t){var n,c,o,i,r,l,s=t.response.venue,u=s.name;try{n=s.bestPhoto.prefix+"height500"+s.bestPhoto.suffix}catch(d){n=void 0}try{c=s.categories[0].name}catch(d){c=void 0}try{o=s.price.tier}catch(d){o=0}try{(i=s.tips.groups[0].items[0].text).length>145&&(i=i.substring(0,145)+"...")}catch(d){i=""}try{r=Math.ceil(621371e-9*a.state.venueResults[e].location.distance)}catch(d){r=""}try{l="".concat(s.location.lat,",").concat(s.location.lng)}catch(d){l=""}a.setState({gettingNextPlace:!1,currentVenue:e,currentVenueDetails:{name:u,photoURL:n,category:c,priceTier:o,tip:i,distance:r,coordinates:l}})}).catch(function(e){alert("Please check your network connection "+e),a.setState({gettingNextPlace:!1})})}},{key:"getNextPlace",value:function(){var e=(this.state.currentVenue+1)%this.state.venueResults.length;this.loadPlaceDetails(e)}},{key:"handleLunchClick",value:function(){var e=this.state.currentVenueDetails,t=e.id,a=e.name,n=e.photoURL;this.setState({savedPlaces:[].concat(Object(r.a)(this.state.savedPlaces),[{id:t,name:a,photoURL:n}])}),window.open("https://www.google.com/maps/dir/?api=1&destination="+this.state.currentVenueDetails.coordinates,"_blank")}},{key:"toggleSidebar",value:function(){this.setState({sidebarVisibility:!this.state.sidebarVisibility})}},{key:"render",value:function(){return c.a.createElement(v.g.Pushable,{className:"places-sidebar"},c.a.createElement(v.g,{as:v.b,animation:"overlay",width:"wide",visible:this.state.sidebarVisibility},c.a.createElement("a",{className:"sidebar-close-toggle",onClick:this.toggleSidebar},c.a.createElement(v.e,{name:"cancel",size:"big",color:"grey"})),c.a.createElement(v.d,{textAlign:"center"},"Saved Places"),c.a.createElement(v.f.Group,{divided:!0},this.state.savedPlaces.map(function(e){return c.a.createElement(x,{key:e.id,name:e.name,photoURL:e.photoURL})}))),c.a.createElement(v.g.Pusher,null,c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("img",{src:j.a,className:"App-logo",alt:"logo"}),c.a.createElement("h1",{className:"App-title"},"Lunch Roulette"),c.a.createElement("p",null,"It's Tinder! But for restaurants"),c.a.createElement(v.a,{color:"grey",onClick:this.toggleSidebar},"Saved Places")),c.a.createElement(v.c,{centered:!0},c.a.createElement(v.c.Column,{computer:6,tablet:8,mobile:15},this.state.currentVenueDetails&&c.a.createElement(N,{venueDetails:this.state.currentVenueDetails,getNextPlace:this.getNextPlace,handleLunchClick:this.handleLunchClick,gettingNextPlace:this.state.gettingNextPlace}))),c.a.createElement("div",{className:"footer"},c.a.createElement("p",null,"Oluwatobi Oremade - Powered by Foursquare.")))))}}]),t}(n.Component),V=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function U(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(c.a.createElement(D,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/lunch-roulette",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/lunch-roulette","/service-worker.js");V?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):U(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):U(e)})}}()}},[[302,2,1]]]);
//# sourceMappingURL=main.e0b5f9b8.chunk.js.map